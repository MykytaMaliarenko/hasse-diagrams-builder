!function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(16),s=n(1),o=n(2),r=n(17);class a{constructor(t){this._root=t,this.dispatcher=new i.Dispatcher,document.getElementById("stage2").hidden=!0,a.components.forEach(t=>{t.init(this._root,this.dispatcher)})}showSecondStage(){document.getElementById("stage1").hidden=!0,document.getElementById("stage2").hidden=!1}}e.UI=a,a.components=[new s.EquationInput,new o.SetInput,new r.BuildDiagramButton]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.EquationInput=class{constructor(){this._leftSideInput=null,this._rightSideInput=null,this._operationSelect=null}init(t,e){this._leftSideInput=document.getElementById("leftEquationInput"),this._rightSideInput=document.getElementById("rightEquationInput"),this._operationSelect=document.getElementById("operationSelect")}isValid(){return!0}get operation(){let t=this._operationSelect.value.replace(/\s/g,"");switch(t){case":":t="::"}return t}value(){return this._leftSideInput.value.replace(/\s/g,"")+this.operation+this._rightSideInput.value.replace(/\s/g,"")}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const validPatterns=[/(\d)+/,/\d+\/\d+/,/(\d)+\*(\d)+/];class SetInput{constructor(){this._input=null}init(t,e){this._input=document.getElementById("setInput"),this._input.onkeydown=t=>setTimeout(()=>this.onInput(t),100)}onInput(t){let e=this._input.value.replace(/\s/g,"").split(",");for(let t of e)if(0==validPatterns.filter(e=>t.match(e)&&t.match(e)[0].length==t.length).length)return this.valid=!1,null;return this.valid=!0,null}set valid(t){t?this._input.classList.remove("not-valid"):this._input.classList.contains("not-valid")||this._input.classList.add("not-valid")}isValid(){return!this._input.classList.contains("not-valid")}value(){let raw=this._input.value.replace(/\s/g,"").split(","),res=Array();return raw.forEach(el=>{el.includes("*")||el.includes("/")?res.push(eval(el)):res.push(parseFloat(el))}),res}}exports.SetInput=SetInput},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ACTION_GO_TO_RENDER="goToRender"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(5),s=n(10);n(12);const o=n(0),r=n(3);window.onload=()=>{let t=new o.UI(document.body);t.dispatcher.on(r.ACTION_GO_TO_RENDER,async e=>{t.showSecondStage();let n=await i.DiagramAPI.buildDiagram(e.equation,e.set),o=document.getElementById("stage2"),r=document.getElementById("mainCanvas"),a=document.getElementById("subCanvas"),c=new s.CoreRender(o,r,a);c.renderData=n,c.render()})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(6),s=n(7),o=n(8),r=n(9);e.DiagramAPI={buildDiagram:async(t,e)=>{let n=await r.api.post("diagramBuilder",JSON.stringify({equation:t,dataset:e}),{"Content-Type":"application/json"});if(n.ok){let t=Array(),e=Array(),r=await n.json();r.points.forEach(e=>{t.push([]),e.forEach(e=>{t[t.length-1].push(new o.Point(e.id,e.value))})});let a=e=>{let n=void 0;return t.forEach(t=>{void 0===n&&(n=t.find(t=>t.id===e))}),n};return r.links.forEach(t=>{e.push(new s.Link(a(t.x),a(t.y)))}),new i.RenderData(t,e)}return null}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.RenderData=class{constructor(t,e){this._points=t,this._links=e}get points(){return this._points}get links(){return this._links}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Link=class{constructor(t,e){this._x=t,this._y=e}get x(){return this._x}get y(){return this._y}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Point=class{constructor(t,e){this._id=t,this._value=e,this.active=!0,this._coords={x:0,y:0}}eq(t){return this._id==t._id}get coords(){return this._coords}set coords(t){this._coords.x=t.x,this._coords.y=t.y}get id(){return this._id}get value(){return this._value}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.api=new class{constructor(t,e){this._backendURL=t,this._defaultHeaders=e}get(t){}post(t,e,n){let i=Object.assign(Object.assign({},this._defaultHeaders),n);return fetch(`${this._backendURL}/${t}`,{method:"POST",mode:"cors",headers:i,body:e})}}("http://127.0.0.1:5000",{})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(11),s=40,o=50;e.CoreRender=class{constructor(t,e,n){this.container=t,this._mainCanvas=e,this._subCanvas=n,this._width=0,this._height=0,this._clicked_point=null,window.onresize=()=>{this.sizes={w:t.clientWidth,h:t.clientHeight},this.render()},this.sizes={w:t.clientWidth,h:t.clientHeight},this._mainCanvasDrawer=i.drawer(this._mainCanvas),this._subCanvasDrawer=i.drawer(this._subCanvas),n.onmousedown=t=>this.onClick(t),n.onmousemove=t=>this.onMouseMove(t),n.onmouseup=()=>this.onMouseUp()}set renderData(t){this._renderData=t,this.calculateCoords()}set sizes(t){this._mainCanvas.width=t.w,this._mainCanvas.height=t.h,this._subCanvas.width=t.w,this._subCanvas.height=t.h,this._width=t.w,this._height=t.h}recalculateCoords(){this.calculateCoords()}render(){this._mainCanvasDrawer.clear(),this._renderData.points.forEach(t=>{t.filter(t=>t.active).forEach(t=>this._mainCanvasDrawer.drawPoint(t))}),this._renderData.links.filter(t=>t.x.active&&t.y.active).forEach(t=>this._mainCanvasDrawer.drawLink(t))}renderSub(){this._subCanvasDrawer.clear(),this._clicked_point&&this._subCanvasDrawer.drawPoint(this._clicked_point)}calculateYStep(t){return(this._height-o)/t}calculateXStep(t){return(this._width-s)/t}calculateCoords(){let t=this._renderData.points,e=this.calculateYStep(t.length-1);t.forEach((t,n)=>{let i=this._height-n*e;if(1!=t.length){let e=this.calculateXStep(t.length-1);t.forEach((t,n)=>{t.coords.x=e*n+s/2,t.coords.y=i-o/2})}else t[0].coords.x=this._width/2+s/2,t[0].coords.y=i-o/2})}onClick(t){let e=t.offsetX,n=t.offsetY;this._renderData.points.every(t=>t.every(t=>(console.log({point:t,delta:{x:Math.abs(t.coords.x-e),y:Math.abs(t.coords.y-n)}}),!(Math.abs(t.coords.x-e)<10&&Math.abs(t.coords.y-n)<10)||(t.active=!t.active,this._clicked_point=t,!1)))),this.render(),this._subCanvasDrawer.clear(),this._subCanvasDrawer.drawPoint(this._clicked_point)}onMouseMove(t){this._clicked_point&&(this._clicked_point.coords={x:t.offsetX,y:t.offsetY},this._subCanvasDrawer.clear(),this._subCanvasDrawer.drawPoint(this._clicked_point))}onMouseUp(){this._clicked_point&&(this._subCanvasDrawer.clear(),this._clicked_point.active=!0,this._clicked_point=null,this.render())}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.drawer=t=>{let e=t.getContext("2d");return{ctx:e,drawPoint(t){this.ctx.beginPath(),this.ctx.arc(t.coords.x,t.coords.y,5,0,2*Math.PI),this.ctx.strokeStyle="#000000",this.ctx.fill(),this.ctx.stroke(),this.ctx.fillText(`${t.value}`,t.coords.x+10,t.coords.y)},drawLink(t){this.ctx.beginPath(),this.ctx.moveTo(t.x.coords.x,t.x.coords.y),this.ctx.lineTo(t.y.coords.x,t.y.coords.y),this.ctx.stroke()},clear(){this.ctx.clearRect(0,0,e.canvas.width,e.canvas.height)}}}},function(t,e,n){var i=n(13),s=n(14);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var o={insert:"head",singleton:!1},r=(i("!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./index.sass",s,o),s.locals?s.locals:{});t.exports=r},function(t,e,n){"use strict";var i,s={},o=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},r=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}();function a(t,e,n){t=n.base?t+n.base:t,s[t]||(s[t]=[]);for(var i=0;i<e.length;i++){var o=e[i],r={css:o[1],media:o[2],sourceMap:o[3]},a=s[t];a[i]?a[i].updater(r):a.push({updater:_(r,n)})}for(var c=e.length;c<s[t].length;c++)s[t][c].updater();s[t].length=e.length,0===s[t].length&&delete s[t]}function c(t){var e=document.createElement("style"),i=t.attributes||{};if(void 0===i.nonce){var s=n.nc;s&&(i.nonce=s)}if(Object.keys(i).forEach((function(t){e.setAttribute(t,i[t])})),"function"==typeof t.insert)t.insert(e);else{var o=r(t.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(e)}return e}var u,l=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function d(t,e,n,i){var s=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=l(e,s);else{var o=document.createTextNode(s),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(o,r[e]):t.appendChild(o)}}function h(t,e,n){var i=n.css,s=n.media,o=n.sourceMap;if(s?t.setAttribute("media",s):t.removeAttribute("media"),o&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var p=null,f=0;function _(t,e){var n,i,s;if(e.singleton){var o=f++;n=p||(p=c(e)),i=d.bind(null,n,o,!1),s=d.bind(null,n,o,!0)}else n=c(e),i=h.bind(null,n,e),s=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else s()}}t.exports=function(t,e,n){return(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=o()),a(t,e,n),function(e){a(t,e||[],n)}}},function(t,e,n){(e=n(15)(!1)).push([t.i,".container{max-width:900px;margin:auto}.container #stage1{max-width:450px;margin:auto}.container #stage1 .row{margin-top:20px;margin-bottom:20px}.container #stage1 .divide{margin-top:40px !important}.container #stage1 .content-center{align-items:center;display:flex;justify-content:space-between}.container #stage1 input[type=text]{outline:none;border:0;border-bottom:1px solid #9e9e9e !important;padding-left:2.5px;padding-bottom:5px}.container #stage1 .full-size-input{width:100%}.container #stage1 select{border:0;outline:none}.container #stage1 p{display:inline-block;width:100%;font-size:1.5rem;margin:0}.container #stage2{position:relative;padding-top:100%}.container #stage2 canvas{position:absolute;left:0;top:0;width:100%;height:100%}.container #stage2 #mainCanvas{z-index:0}.container #stage2 #subCanvas{z-index:1}\n",""]),t.exports=e},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var s=(r=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),o=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot).concat(t," */")}));return[n].concat(o).concat([s]).join("\n")}var r,a,c;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i=0;i<t.length;i++){var s=[].concat(t[i]);n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),e.push(s)}},e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Dispatcher=class{constructor(){this._listeners={}}on(t,e){this._listeners[t]||(this._listeners[t]=Array()),this._listeners[t].push(e)}emit(t,e={}){this._listeners[t].forEach(t=>t(e))}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(0),s=n(1),o=n(2),r=n(3);e.BuildDiagramButton=class{constructor(){this._button=null,this._dispatcher=null}init(t,e){this._button=document.getElementById("buildDiagramButton"),this._button.onclick=()=>this.onClick(),this._dispatcher=e}onClick(){let t=i.UI.components,e=t.filter(t=>t instanceof o.SetInput)[0],n=t.filter(t=>t instanceof s.EquationInput)[0];if(e.isValid()&&n.isValid()){let t={equation:n.value(),set:e.value()};this._dispatcher.emit(r.ACTION_GO_TO_RENDER,t)}}isValid(){return!1}value(){}}}]);
//# sourceMappingURL=main.js.map